# Copyright 2016 FIX94
# This code is licensed to you under the terms of the GNU GPL, version 2;
# see file LICENSE or http://www.gnu.org/licenses/old-licenses/gpl-2.0.txt

# Modifications made by AECX and Zephiles

ifeq ($(strip $(DEVKITPPC)),)
$(error "Please set DEVKITPPC in your environment. export DEVKITPPC=<path to>/devkitPPC")
endif

# Create CROSS variable for the loader Makefile
export CROSS:=$(DEVKITPPC)/bin/powerpc-eabi-

ifeq ($(VERSION),)
all:
us:
	@$(MAKE) --no-print-directory VERSION=us
eu0:
	@$(MAKE) --no-print-directory VERSION=eu0
eu1:
	@$(MAKE) --no-print-directory VERSION=eu1
endif

all:
	@$(MAKE) --no-print-directory -C loader
	@mv -f loader/loader.h exploit/loader.h
	@$(MAKE) --no-print-directory -C exploit
	@mkdir -p bin
	@mv -f exploit/*.bin bin

clean:
	@$(MAKE) --no-print-directory -C loader clean
	@$(MAKE) --no-print-directory -C exploit clean
	rm -rf exploit/loader.h
	rm -rf bin/*.bin